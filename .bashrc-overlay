#!/bin/bash
#
# Copyright (C) 2020 The Android Open Source Project
#
# SPDX-License-Identifier: Apache-2.0
#

# Variables
AOSP_MAIN_DIR="/mnt/data/Android"
ANDROID_NDK_VERSION="25.2.9519653"
ANDROID_BUILD_TOOLS_VERSION="34.0.0-rc4"

# Add ~/bin to PATH, so scripts inside it can be executed
export PATH="$PATH:~/bin"

# Add ~/.local/bin to PATH, so scripts inside it can be executed
export PATH="$PATH:~/.local/bin"

# Enable ccache on AOSP building
export USE_CCACHE=1
export CCACHE_EXEC=/usr/bin/ccache
if [ -d "/mnt/data/ccache" ]; then
	export CCACHE_DIR=/mnt/data/ccache
else
	export CCACHE_DIR=~/ccache
fi

# Source build/envsetup.sh if found
if [ -f "build/envsetup.sh" ]; then
	echo "AOSP build/envsetup.sh found, sourcing..."
	source build/envsetup.sh
	echo "Done"
else
	export ANDROID_HOME=~/Android/Sdk
	export ANDROID_SDK_ROOT="${ANDROID_HOME}"
	export ANDROID_NDK_HOME="${ANDROID_SDK_ROOT}/ndk/${ANDROID_NDK_VERSION}"
	export PATH="${PATH}:${ANDROID_HOME}/build-tools/${ANDROID_BUILD_TOOLS_VERSION}"
	export PATH="${PATH}:${ANDROID_HOME}/tools"
	export PATH="${PATH}:${ANDROID_HOME}/platform-tools"
fi

alias pip3.9="python3.9 -m pip"

# Add gem to PATH
export PATH="$PATH:~/.local/share/gem/ruby/3.0.0/bin"

# Enable pipx completions
eval "$(register-python-argcomplete pipx)"
